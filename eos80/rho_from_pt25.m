function rho = rho_from_pt25(s,pt,p)

%   in-situ density from potential temperature
%   Jackett, McDougall, Feistel, Wright and Griffies (2006), JAOT
%
%   usage        : rho = rho_from_theta(s,th,p)
%
%   s            : salinity                           (psu)
%   pt           : potential temperature              (deg C, ITS-90)
%   p            : sea pressure                       (dbar)
%                  (absolute pressure - 10.1325 dbar)
%
%   rho          : in-situ density                    (kg/m^3)
%



pt2 = pt.*pt;
sqrts = sqrt(s);
ppt = p.*pt;

numerator =             9.9984085444849347d+02 + ...
             pt.*( 7.3471625860981584d+00 + ...
             pt.*(-5.3211231792841769d-02 + ...
             pt *  3.6492439109814549d-04)) + ...
              s.*( 2.5880571023991390d+00 + ...
             pt * -6.7168282786692355d-03 + ...
              s *  1.9203202055760151d-03) + ...
              p.*( 1.1798263740430364d-02 + ...
            pt2 *  9.8920219266399117d-08 + ...
              s *  4.6996642771754730d-06 - ...
              p.*( 2.5862187075154352d-08 + ...
            pt2 *  3.2921414007960662d-12));

denomator =             1.0000000000000000d+00 + ...
             pt.*( 7.2815210113327091d-03 + ...
             pt.*(-4.4787265461983921d-05 + ...
             pt.*( 3.3851002965802430d-07 + ...
             pt *  1.3651202389758572d-10))) + ...
              s.*( 1.7632126669040377d-03 - ...
             pt.*( 8.8066583251206474d-06 + ...
            pt2 *  1.8832689434804897d-10) + ...
          sqrts.*( 5.7463776745432097d-06 + ...
            pt2 *  1.4716275472242334d-09)) + ...
              p.*( 6.7103246285651894d-06 - ...
      ppt.*(pt2 *  2.4461698007024582d-17 + ...
              p *  9.1534417604289062d-18));


rho = numerator./denomator;


end